<!DOCTYPE html>
<html lang="vi">
<head>
  <link rel="icon" type="image/jpeg" href="images/icon.jpg">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>NÆ¡i lÆ°u giá»¯ ká»· niá»‡m - THCS Nguyá»…n Thá»‹ Minh Khai</title>
  
  <link rel="stylesheet" href="style.css">

<!-- ========== Káº¾T Ná»I FIREBASE + THá»NG KÃŠ TRUY Cáº¬P ========== -->
<script type="module">
  import { 
    initializeApp 
  } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
  import { 
    getDatabase, ref, push, onChildAdded,
    get, set, update, onValue, onDisconnect 
  } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-database.js";

  // ğŸ”§ Cáº¥u hÃ¬nh Firebase
  const firebaseConfig = {
    apiKey: "AIzaSyBzAGsqCusrg_2L0Lw2YiOgcmdBJa0ZGCM",
    authDomain: "lop-8-1-chat.firebaseapp.com",
    databaseURL: "https://lop-8-1-chat-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "lop-8-1-chat",
    storageBucket: "lop-8-1-chat.appspot.com",
    messagingSenderId: "512094801159",
    appId: "1:512094801159:web:d775b5e653d9f2db53c9a2",
    measurementId: "G-R7PV1C79JT"
  };

  // ğŸš€ Khá»Ÿi táº¡o Firebase
  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  // Gáº¯n vÃ o window Ä‘á»ƒ script.js dÃ¹ng Ä‘Æ°á»£c
  window.db = db;
  window.ref = ref;
  window.push = push;
  window.onChildAdded = onChildAdded;
  window.onValue = onValue;

  // ==============================
  // ğŸ”¹ THá»NG KÃŠ TRUY Cáº¬P REALTIME
  // ==============================
  const now = new Date();
  const todayKey = now.toISOString().slice(0, 10);
  const yesterdayKey = new Date(now - 86400000).toISOString().slice(0, 10);

  const todayRef = ref(db, "visitors/days/" + todayKey);
  get(todayRef).then(snap => set(todayRef, (snap.exists() ? snap.val() : 0) + 1));

  const userId = Date.now().toString(36) + Math.random().toString(36).slice(2);
  set(ref(db, "visitors/online/" + userId), true);
  onDisconnect(ref(db, "visitors/online/" + userId)).remove();

  onValue(ref(db, "visitors/online"), snap => {
    const val = snap.val();
    document.getElementById("online").textContent = val ? Object.keys(val).length : 0;
  });

  onValue(ref(db, "visitors/days"), snap => {
    const data = snap.val() || {};
    const days = Object.keys(data).sort();
    const today = data[todayKey] || 0;
    const yesterday = data[yesterdayKey] || 0;

    const startOfWeek = new Date(now);
    startOfWeek.setDate(now.getDate() - now.getDay() + 1);
    const startOfMonth = new Date(now.getFullYear(), now.getMonth(), 1);

    let thisWeek = 0, lastWeek = 0, thisMonth = 0, lastMonth = 0;
    for (let [day, count] of Object.entries(data)) {
      const d = new Date(day);
      const weekDiff = Math.floor((now - d) / 604800000);
      const monthDiff = now.getMonth() - d.getMonth() + 12 * (now.getFullYear() - d.getFullYear());
      if (d >= startOfWeek) thisWeek += count;
      else if (weekDiff === 1) lastWeek += count;
      if (d >= startOfMonth) thisMonth += count;
      else if (monthDiff === 1) lastMonth += count;
    }

    document.getElementById("today").textContent = today;
    document.getElementById("yesterday").textContent = yesterday;
    document.getElementById("thisweek").textContent = thisWeek;
    document.getElementById("lastweek").textContent = lastWeek;
    document.getElementById("thismonth").textContent = thisMonth;
    document.getElementById("lastmonth").textContent = lastMonth;
  });
</script>

  <script src="script.js" defer></script>
</head>
<body>
  <!-- ===== HEADER ===== -->
 <header>
  <div class="header-container">
    <!-- Logo trÃ¡i -->
    <img src="images/style/logo.jpg" alt="Logo lá»›p 8/1" class="logo">

  <div class="center-block">
      <div class="sub-title">BÃ¡o Ä‘iá»‡n tá»­</div>
      <p></p>
      <div class="title-container">
        <h1 class="fire-text"><span>Táº­p thá»ƒ Lá»›p 8/1</span></h1>
      </div>
      <div class="fire-text small-text">Tri thá»©c lÃ  chÃ¬a khÃ³a má»Ÿ cá»­a thÃ nh cÃ´ng</div>
    </div>
    
    <!-- NÃºt nháº¡c gÃ³c pháº£i -->
    <button id="playMusicBtn" title="Báº¥m Ä‘á»ƒ nghe nháº¡c ğŸµ">
      <span class="music-icon">ğŸ¶</span>
      <span class="finger">ğŸ‘ˆ</span>
    </button>

  </div>
</header>
     
  <!-- ===== MENU HÃ€NG NGANG ===== -->
  <nav class="navbar">
    <ul>
      <li><a href="memories.html" class="sparkle-text">GÃ³c hÃ¬nh áº£nh</a></li>

<li>
  <a href="#" class="sparkle-text" onclick="goToLoingo()">Lá»i ngá»</a>
</li>

<script>
function goToLoingo() {
  localStorage.setItem("autoPlayLoingo", "true");
  window.location.href = "loingo.html"; // chuyá»ƒn trang
}
</script>

    <li><a href="gocsangtao.html" class="sparkle-text">GÃ³c sÃ¡ng táº¡o</a></li>
      <li>
  <a href="luubut.html" class="sparkle-text luubut">
    <span class="text">LÆ°u bÃºt</span>
    <span class="butterfly">ğŸ¦‹</span>
  </a>
</li>
    </ul>
  </nav>

  <!-- ===== Ná»˜I DUNG CHÃNH ===== -->
  <main>
    <section class="intro">
    <h2>ğŸ’— NÆ¡i lÆ°u giá»¯ ká»· niá»‡m, tÃ¬nh cáº£m cá»§a há»c sinh vá» tháº§y cÃ´, báº¡n bÃ¨ vÃ  mÃ¡i trÆ°á»ng THCS Nguyá»…n Thá»‹ Minh Khai-X.HÃ³c MÃ´n ğŸ’—</h2>
    <p></p>
    </section>

    <section class="grid-gallery">
  <a href="memories.html" class="card">
    <div class="img-border">
    <img src="images/memories/tapthe2.jpg" alt="">
   
    <p class="rainbow-text">GÃ³c hÃ¬nh áº£nh-Ká»· niá»‡m Ä‘Ã¡ng nhá»›</p>
    </div>
  </a>
   <a href="loingo.html" class="card" onclick="localStorage.setItem('autoPlayLoingo','true')">
    <div class="img-border">
    <img src="images/loingo.jpg" alt="">
  
    <p class="rainbow-text">Lá»i ngá»</p>
    </div>
  </a>
  <a href="gocsangtao.html" class="card">
    <div class="img-border">
      <img src="images/memories/thiep3.jpg" alt="">
      
    <p class="rainbow-text">GÃ³c sÃ¡ng táº¡o</p>
    </div>
  </a>
  <a href="luubut.html" class="card">
     <div class="img-border">
    <img src="images/2010.jpg" alt="">
    
    <p class="rainbow-text">LÆ°u bÃºt</p>
    </div>
  </a>
</section>

  </main>

  <!-- ===== NÃšT ZALO =====
  <a href="https://zalo.me/xxx" class="zalo-button" target="_blank" title="LiÃªn há»‡ qua Zalo">
    <img src="images/style/iconzalo.png" alt="Zalo">
  </a> -->

  
  
  <!-- CHAT BOX -->
   <button class="chat-floating-btn" id="chatToggleBtn">ğŸ’¬</button> 
<div id="chatBox" class="chatbox">
  <div id="chatHeader" class="chatbox-header" onclick="toggleChat()">
    ğŸ’¬ <b>Chat cÃ¹ng nhau</b>
  </div>

  <div id="chatBody" class="chatbox-body">
    <div id="chatMessages" class="messages"></div>
    <div class="chat-input">
  <input type="text" id="chatMessage" placeholder="Nháº­p tin nháº¯n..." />
  <button type="button" id="emojiBtn">ğŸ˜„</button>
  <button onclick="sendMessage()">Gá»­i</button>
</div>

<!-- Báº£ng emoji áº©n/hiá»‡n -->
<div id="emojiPanel" class="emoji-panel">
  <span onclick="addEmoji('ğŸ˜€')">ğŸ˜€</span>
  <span onclick="addEmoji('ğŸ˜')">ğŸ˜</span>
  <span onclick="addEmoji('ğŸ˜‚')">ğŸ˜‚</span>
  <span onclick="addEmoji('ğŸ¤£')">ğŸ¤£</span>
  <span onclick="addEmoji('ğŸ˜Š')">ğŸ˜Š</span>
  <span onclick="addEmoji('ğŸ˜')">ğŸ˜</span>
  <span onclick="addEmoji('ğŸ˜˜')">ğŸ˜˜</span>
  <span onclick="addEmoji('ğŸ˜')">ğŸ˜</span>
  <span onclick="addEmoji('ğŸ˜¢')">ğŸ˜¢</span>
  <span onclick="addEmoji('ğŸ˜­')">ğŸ˜­</span>
  <span onclick="addEmoji('ğŸ˜¡')">ğŸ˜¡</span>
  <span onclick="addEmoji('ğŸ˜±')">ğŸ˜±</span>
  <span onclick="addEmoji('ğŸ¤©')">ğŸ¤©</span>
  <span onclick="addEmoji('ğŸ¥³')">ğŸ¥³</span>
  <span onclick="addEmoji('ğŸ‘')">ğŸ‘</span>
  <span onclick="addEmoji('ğŸ‘')">ğŸ‘</span>
  <span onclick="addEmoji('ğŸ™')">ğŸ™</span>
  <span onclick="addEmoji('ğŸ‰')">ğŸ‰</span>
  <span onclick="addEmoji('ğŸ’—')">ğŸ’—</span>
  <span onclick="addEmoji('ğŸ”¥')">ğŸ”¥</span>
</div>

  </div>
</div>

<!-- ===== Ã” NHáº¬P TÃŠN NGÆ¯á»œI DÃ™NG (chá»‰ hiá»‡n khi cáº§n) ===== -->
<div id="namePrompt" style="
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  display: none;
  align-items: center;
  justify-content: center;
  background: rgba(0,0,0,0.6);
  z-index: 3000;
">
  <div style="
    background: white;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.3);
    text-align: center;
    max-width: 300px;
  ">
    <h3>Nháº­p tÃªn cá»§a báº¡n</h3>
    <input type="text" id="usernameInput" placeholder="VD: Hieu, Lan..." style="width: 100%; padding: 8px; margin-top: 10px;">
    <button onclick="saveUsername()" style="margin-top: 10px; padding: 8px 15px; background:#1e3d7b; color:white; border:none; border-radius:5px; cursor:pointer;">LÆ°u tÃªn</button>
  </div>
</div>


 

 <!-- ğŸµ Nháº¡c ná»n áº©n, phÃ¡t khi ngÆ°á»i dÃ¹ng báº¥m nÃºt -->
<audio id="bgMusic" loop preload="none"></audio>

<script>
const btn = document.getElementById("playMusicBtn");
const music = document.getElementById("bgMusic");

// ğŸ”¹ Danh sÃ¡ch nháº¡c
const playlist = [
  "music/tbdk.mp3"
];
let currentTrack = 0;

function fadeInMusic() {
  let vol = 0;
  music.volume = 0;
  const fade = setInterval(() => {
    if (vol < 1) {
      vol += 0.05;
      music.volume = Math.min(vol, 1);
    } else clearInterval(fade);
  }, 100);
}

function playTrack(index) {
  currentTrack = index;
  music.src = playlist[currentTrack];
  music.play()
    .then(() => fadeInMusic())
    .catch(err => console.log("Autoplay bá»‹ cháº·n:", err));
}

// ğŸ”¹ Khi nháº¡c káº¿t thÃºc â†’ qua bÃ i káº¿ (vÃ²ng láº¡i náº¿u háº¿t)
music.addEventListener("ended", () => {
  currentTrack = (currentTrack + 1) % playlist.length;
  playTrack(currentTrack);
});

// ğŸ”¹ Khi ngÆ°á»i dÃ¹ng báº¥m nÃºt
btn.addEventListener("click", () => {
  playTrack(currentTrack);
  btn.disabled = true;
  btn.style.opacity = 0.7;
});
</script>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const fireText = document.querySelector(".fire-text");
  const letters = fireText.textContent.split("");
  fireText.textContent = "";
  letters.forEach(ch => {
    const span = document.createElement("span");
    span.textContent = ch;
    fireText.appendChild(span);
  });
});
</script>

<script>
window.addEventListener("scroll", () => {
  const footer = document.querySelector("footer");
  const atBottom = window.innerHeight + window.scrollY >= document.body.offsetHeight - 10;

  if (atBottom) {
    footer.classList.add("show");
  } else {
    footer.classList.remove("show");
  }
});
</script>

<!-- ğŸ”¹ NÃºt má»Ÿ thá»‘ng kÃª truy cáº­p -->
<div id="stats-toggle">></div>

<!-- ğŸ”¹ Khung thá»‘ng kÃª truy cáº­p -->
<div id="stats-panel">
  <h3>THá»NG KÃŠ TRUY Cáº¬P</h3>
 <p>ğŸ‘¤ Äang online: <span id="online">0</span></p>
<p>ğŸ“… HÃ´m nay: <span id="today">0</span></p>
<p>ğŸ“† HÃ´m qua: <span id="yesterday">0</span></p>
<p>ğŸ“ˆ Tuáº§n nÃ y: <span id="thisweek">0</span></p>
<p>ğŸ“Š Tuáº§n trÆ°á»›c: <span id="lastweek">0</span></p>
<p>ğŸ—“ï¸ ThÃ¡ng nÃ y: <span id="thismonth">0</span></p>
<p>ğŸ“… ThÃ¡ng trÆ°á»›c: <span id="lastmonth">0</span></p>

</div>

<script>
  const toggleBtn = document.getElementById("stats-toggle");
  const statsPanel = document.getElementById("stats-panel");

  toggleBtn.addEventListener("click", () => {
    toggleBtn.classList.toggle("open");
    statsPanel.classList.toggle("open");
    toggleBtn.textContent = statsPanel.classList.contains("open") ? "<" : ">";
  });
</script>


 <!-- ===== FOOTER ===== -->
  <footer>
    <p>&copy; 2025 Lá»›p 8/1 - GV chá»§ nhiá»‡m cÃ´ Pháº¡m Nguyá»…n Thanh PhÆ°Æ¡ng</p>
  </footer>

<body>
  
  <script>
// ===== Táº®T NHáº C Ná»€N KHI Rá»œI TRANG =====
window.addEventListener("beforeunload", () => {
  const music = document.getElementById("bgMusic");
  if (music) {
    music.pause();
    music.currentTime = 0; // tua vá» Ä‘áº§u
  }
});

// ===== Táº®T NHáº C KHI Báº¤M LINK SANG TRANG KHÃC =====
document.querySelectorAll("a").forEach(link => {
  link.addEventListener("click", () => {
    const music = document.getElementById("bgMusic");
    if (music) {
      music.pause();
      music.currentTime = 0;
    }
  });
});
</script>

 </html>



